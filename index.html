<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Tic Tac Toe</title>
  <link rel="stylesheet" type="text/css" href="styles/style.css" />
</head>
<body>
  <h1>Tic Tac Toe</h1>
  <table id="table">
    <tbody id="tbodyid">
      <tr>
        <td class="click x1 y3"></td>
        <td class="click x2 y3"></td>
        <td class="click x3 y3"></td>
      </tr>
      <tr>
        <td class="click x1 y2"></td>
        <td class="click x2 y2"></td>
        <td class="click x3 y2"></td>
      </tr>
      <tr>
        <td class="click x1 y1"></td>
        <td class="click x2 y1"></td>
        <td class="click x3 y1"></td>
      </tr>
    </tbody>
  </table>

  <script
  src="https://code.jquery.com/jquery-3.2.1.js"
  integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
  crossorigin="anonymous">
  </script>
  <script type="text/javascript">
  $( document ).ready(function() {
    console.log( "ready!" );
      tour = 1;
      $('.click').on('click', function(){
        if ($(this).html() == '') {
          if(tour % 2 == 0){
            $(this).text('o');
          } else {
            $(this).text('x');
          }
          checkWin(tour);
          tour += 1;

        }
      })
    });

    function checkWin (nombredetours) {
      estqueqqnagane = false
      tabVal = ["a","b","c","d","e","f","g","h","i"]
      idx = 0
      end = false

      $('table tr td').each(function()
      {
        if($(this).html() != ""){
          tabVal[idx] = $(this).html()
        }
        idx = idx + 1
        console.log(tabVal)
      });


      //Test de la première ligne
      if(tabVal[0] == tabVal[1] && tabVal[0] == tabVal[2]){
        //console.log("Au tour " + nombredetours + ", " + tabVal[0] + " a gagné")
        estqueqqnagane = tabVal[0]
      }

      //Test de la deuxième ligne
      if(tabVal[3] == tabVal[4] && tabVal[3] == tabVal[5]){
        //console.log("Au tour " + nombredetours + ", " + tabVal[3] + " a gagné")
        estqueqqnagane = tabVal[3]
      }

      //Test de la troisième ligne
      if(tabVal[6] == tabVal[7] && tabVal[6] == tabVal[8]){
        //console.log("Au tour " + nombredetours + ", " + tabVal[6] + " a gagné")
        estqueqqnagane = tabVal[6]
      }

      //Test de la première colonne
      if(tabVal[0] == tabVal[3] && tabVal[0] == tabVal[6]){
        //console.log("Au tour " + nombredetours + ", " + tabVal[0] + " a gagné")
        estqueqqnagane = tabVal[0]
      }

      //Test de la deuxième colonne
      if(tabVal[1] == tabVal[4] && tabVal[1] == tabVal[7]){
        //console.log("Au tour " + nombredetours + ", " + tabVal[1] + " a gagné")
        estqueqqnagane = tabVal[1]
      }

      //Test de la troisième colonne
      if(tabVal[2] == tabVal[5] && tabVal[2] == tabVal[8]){
        //console.log("Au tour " + nombredetours + ", " + tabVal[2] + " a gagné")
        estqueqqnagane = tabVal[2]
      }

      //Test de la première diagonale
      if(tabVal[0] == tabVal[4] && tabVal[0] == tabVal[8]){
        //console.log("Au tour " + nombredetours + ", " + tabVal[0] + " a gagné")
        estqueqqnagane = tabVal[0]
      }

      //Test de la deuxième diagonale
      if(tabVal[2] == tabVal[4] && tabVal[2] == tabVal[6]){
        //console.log("Au tour " + nombredetours + ", " + tabVal[2] + " a gagné")
        estqueqqnagane = tabVal[2]
      }

      if(estqueqqnagane){
        alert("Quelqu'un a gagné! c'est " + estqueqqnagane)
        end = true
      } else if (tour == 9) {
        alert("EGALITE")
        end = true
      }

      if(end){
        if (confirm("Voulez-vous rejouer ?")) {
          // oui il le veut
          location.reload();
        } else {
          // non il en a marre
        }
      }
    // TODO - que faire si personne n'a gagné -> EGALITE
    // TODO - A la fin de la partie, demander si on veut recommencer une partie
    // TODO - Faire une IA pour jouer tout seul
    }

  </script>
</body>
</html>
